# 6. Docker 볼륨 활용

## 1.1 호스트와 컨테이너 데이터 공유

```bash
docker run -d \
--name db-maria \
--network wp-network \
-p 3306:3306 \
-e MYSQL_ROOT_PASSWORD=rootPw \
-e MYSQL_DATABASE=db_test \
-v ./volume/db-maria:/var/lib/mysql \
mariadb
```

컨테이너 삭제 후에도 데이터가 호스트에 남음
`docker rm -f db-maria`
호스트에서 직접 삭제하면 컨테이너에서도 데이터 삭제됨

## 2 볼륨 전용 컨테이너와 공유

## 2.1 볼륨 컨테이너 생성

```bash
docker run -it \
--name volume_override \
-v ./volume/db-maria:/home/testdir_2 \
alicek106/volume_test
```

컨테이너 내부 경로 /home/testdir_2에 MariaDB 데이터 존재

```bash
root@a1747849eb4c:/home/testdir_2# ls
aria_log.00000001 aria_log_control db_test ddl_recovery.log ib_buffer_pool ib_logfile0 ibdata1 ibtmp1 mariadb_upgrade_info multi-master.info mysql performance_schema sys tc.log undo001 undo002 undo003
```

## 2.2 다른 컨테이너에서 공유

```bash
docker run -it \
--name volume-container \
--volumes-from volume_override \
ubuntu:22.04
```

컨테이너 내부 확인:

```bash
root@e7b71f996eca:/# cd /home/testdir_2
root@e7b71f996eca:/home/testdir_2# ls
aria_log.00000001 aria_log_control db_test ddl_recovery.log ib_buffer_pool ib_logfile0 ibdata1 ibtmp1 mariadb_upgrade_info multi-master.info mysql performance_schema sys tc.log undo001 undo002 undo003
```

`--volumes-from`를 통해 볼륨만 공유 가능
호스트와 직접 공유할 수도 있으며, 컨테이너 삭제 시 데이터는 유지됨

## 2.3 도커 볼륨 이용

도커 자체에서 제공하는 볼륨기능을 활용해서, 데이터를 보존할 수도 있다.

도커 볼륨 생성

```bash
docker volume create --name my_volume
```

볼륨 접근

```bash
docker run -it --name my_volume_1 \
-v my_volume:/root/ \
ubuntu

root@52f7d4e3cce0:/# echo hello,volume! >> /root/volume

root@52f7d4e3cce0:~# cat volume
hello,volume!
```

타 컨테이너 볼륨 확인

```bash
docker run -it --name my_volume_2 \
-v my_volume:/root/ \
ubuntu
```

## 2.4 컨테이너 확인

```bash
docker inspect --type volume my_volume
```

```json
{
  "CreatedAt": "2025-09-13T21:09:56+09:00",
  "Driver": "local",
  "Labels": null,
  "Mountpoint": "/var/lib/docker/volumes/my_volume/_data",
  "Name": "my_volume",
  "Options": null,
  "Scope": "local"
}if
```
